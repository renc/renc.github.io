<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Char Array vs Char Pointer</title>
        <link rel="stylesheet" href="/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">阿can's  blog </a></h1>
                <nav><ul>
                    <li><a href="/pages/about_page.html">About</a></li>
                    <li><a href="/category/.html"></a></li>
                    <li><a href="/category/computer-graphics.html">Computer Graphics</a></li>
                    <li class="active"><a href="/category/programming.html">programming</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/Char Array vs Char Pointer.html" rel="bookmark"
           title="Permalink to Char Array vs Char Pointer">Char Array vs Char Pointer</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2014-09-19T12:00:00">
                Published: 周五 19 九月 2014
        </abbr>
		<br />
        <abbr class="modified" title="2014-09-19T23:30:00">
                Updated: 周五 19 九月 2014
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/.html"></a>
        </address>
<p>In <a href="/category/programming.html">programming</a>. </p>
<p>tags: <a href="/tag/.html"></a> </p>
</footer><!-- /.post-info -->      <p>刚才在阅读以下内容时候复习了一下这两个概念. 
<a href="http://www.bfilipek.com/2014/07/quick-case-char-pointer-vs-char-array.html">Quick case: Char Pointer vs Char Array in C++, by Bartlomiej Filipek</a>  </p>
<div class="highlight"><pre><span class="c1">// Test case of char array vs char pointer. </span>
<span class="c1">// </span>

<span class="p">#</span><span class="k">include</span> <span class="o">&lt;</span><span class="n">iostream</span><span class="o">&gt;</span>   

<span class="k">int</span> <span class="n">main</span><span class="p">()</span>     
<span class="p">{</span>       
    <span class="n">char</span> <span class="n">strA</span><span class="p">[]</span> <span class="o">=</span> <span class="s">&quot;char array!&quot;</span><span class="p">;</span>          
    <span class="n">char</span> <span class="o">*</span><span class="n">strP</span> <span class="o">=</span> <span class="s">&quot;char array?&quot;</span><span class="p">;</span>        

    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;sizeof(strA): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">strA</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, of: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">strA</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, addr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">strA</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>          
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;sizeof(strA): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">strA</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, of: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">strA</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, addr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">strA</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>           
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;sizeof(strP): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">strP</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, of: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">strP</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, addr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">strP</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>            
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;sizeof(strP): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sizeof</span><span class="p">(</span><span class="n">strP</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, of: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">*</span><span class="n">strP</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;, addr: &quot;</span> <span class="o">&lt;&lt;</span> <span class="o">&amp;</span><span class="n">strP</span> <span class="o">&lt;&lt;</span> <span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>          

    <span class="n">strA</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;C&#39;</span><span class="p">;</span>              
    <span class="n">strP</span><span class="p">[</span><span class="mh">0</span><span class="p">]</span> <span class="o">=</span> <span class="sc">&#39;C&#39;</span><span class="p">;</span>           

    <span class="k">return</span> <span class="mh">1</span><span class="p">;</span>            
<span class="p">}</span>       
</pre></div>


<p>Visual Studio 2012, Debug输出为, 这是其中一个结果:   </p>
<div class="highlight"><pre><span class="k">sizeof</span><span class="p">(</span><span class="n">strA</span><span class="p">)</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="n">of</span><span class="o">:</span> <span class="kt">char</span> <span class="n">array</span><span class="o">!</span><span class="p">,</span> <span class="n">addr</span><span class="o">:</span> <span class="mo">00</span><span class="mi">9</span><span class="n">AFAC4</span>           
<span class="k">sizeof</span><span class="p">(</span><span class="n">strA</span><span class="p">)</span><span class="o">:</span> <span class="mi">12</span><span class="p">,</span> <span class="n">of</span><span class="o">:</span> <span class="kt">char</span> <span class="n">array</span><span class="o">!</span><span class="p">,</span> <span class="n">addr</span><span class="o">:</span> <span class="mo">00</span><span class="mi">9</span><span class="n">AFAC4</span>         
<span class="k">sizeof</span><span class="p">(</span><span class="n">strP</span><span class="p">)</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">of</span><span class="o">:</span> <span class="kt">char</span> <span class="n">array</span><span class="o">?</span><span class="p">,</span> <span class="n">addr</span><span class="o">:</span> <span class="mo">00</span><span class="mi">9</span><span class="n">AFAB8</span>           
<span class="k">sizeof</span><span class="p">(</span><span class="n">strP</span><span class="p">)</span><span class="o">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">of</span><span class="o">:</span> <span class="n">c</span><span class="p">,</span> <span class="n">addr</span><span class="o">:</span> <span class="mo">00</span><span class="mi">9</span><span class="n">AFAB8</span>              
</pre></div>


<p>接着就是crash:<br />
<img alt="Alt text" src="data/2014-09-19-CharArrayVsCharPointer_crash.PNG" title="output" />   </p>
<p>Crash的原因是strP指向的是一个ready-only memory, from <a href="">C++ FAQ</a>:</p>
<blockquote>
<p>A <em>string literal</em> (the formal term for a double-quoted string in C source) can be used in two slightly different ways:                 <br />
1) As the initializer for an array of char, as in the declaration of char a[] , it specifies the initial values of the characters in that array (and, if necessary, its size).           <br />
2) Anywhere else, it turns into an unnamed, static array of characters, and this unnamed array may be stored in read-only memory, and which therefore cannot necessarily be modified.            </p>
</blockquote>
<p>我觉得底下的memory可以简单理解为:      <br />
<img alt="memory layout" src="data/2014-09-19-CharArrayVsCharPointer_mem.PNG" title="output" />  </p>
<p>To read list:<br />
<a href="http://www.reddit.com/r/cpp/">reddit/cpp</a> 上面有些cpp的信息.  <br />
<a href="http://www.bfilipek.com/2014/03/what-you-should-know-about-c11.html">What u should know about C++ 11, by Bartlomiej Filipek</a>;     <br />
<a href="http://www.drdobbs.com/cpp/the-c14-standard-what-you-need-to-know/240169034">The C++14 Standard: What u Need to Know</a>;<br />
<a href="http://www.bfilipek.com/2013/02/smart-pointers-gotchas.html">Smart pointers gotchas, by Bartlomiej Filipek</a>;<br />
<a href="http://my.safaribooksonline.com/book/programming/cplusplus/9781491908419">book, Effective Modern C++, by Scott Meyers, 2014</a>;<br />
<a href="https://github.com/CppCon/CppCon2014">CppCon 2014 Speaker Materials</a> ;   </p>
<p>Multithreading for Visual Effects, book from Siggraph 2013 course note.  <a href="http://www.fevrierdorian.com/blog/post/2014/08/24/Multithreading-for-Visual-Effects-book-review">Book Review from Dorian Fevrier's blog</a> 
之前有一本是Polygonal Mesh Processing, 也是源于siggraph course note. <br />
讲多线程的, 让我想起了[book, C++ Concurrency in Action: Practical Multithreading, by Anthony Williams] 书的评价也是很高的.    </p>
<p><a href="http://www.fevrierdorian.com/blog/">A CG nerd tale, Dorian Fevrier's blog</a>;  </p>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>blogroll</h2>
                        <ul>
                            <li><a href="http://getpelican.com/">Pelican</a></li>
                            <li><a href="#">You can modify those links in your config file</a></li>
                        </ul>
                </div><!-- /.blogroll -->
                <div class="social">
                        <h2>social</h2>
                        <ul>

                            <li><a href="#">You can add links in your config file</a></li>
                            <li><a href="https://github.com/renc">Github</a></li>
                        </ul>
                </div><!-- /.social -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>